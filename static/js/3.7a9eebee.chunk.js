(this["webpackJsonpproject-3"]=this["webpackJsonpproject-3"]||[]).push([[3],{437:function(e,t,r){e.exports={chatPage:"ChatPage_chatPage__2nDyn",chat:"ChatPage_chat__3AFOR"}},438:function(e,t,r){e.exports={form:"ChatForm_form__3X8R5",formItem:"ChatForm_formItem__2qgkn"}},439:function(e,t,r){e.exports={user:"Message_user__3uUI-",userInfo:"Message_userInfo__1lLP9",nameAndMess:"Message_nameAndMess__1giLx",userName:"Message_userName__2N0_U",message:"Message_message__2Bi20",bottomLine:"Message_bottomLine__1phg0"}},441:function(e,t,r){"use strict";r.r(t),r.d(t,"Chat",(function(){return A}));var n=r(1),o=r.n(n),s=r(437),c=r.n(s),a=r(8),i=r(438),l=r.n(i),u=r(428),p=r(425),h=r(426),m=r(104),f=r(23),d=r(51),b=r(170),j=r.n(b),g=r(16),O=r(182),v=function(e){return e.chat.messages},_=function(e){return e.chat.wsStatus},x=r(45),R=r.n(x),y=r(2),w=u.a.Item,C=o.a.memo((function(){var e=Object(g.b)(),t=Object(g.c)(_);return Object(y.jsx)(f.d,{initialValues:{messageText:""},validate:function(e){},onSubmit:function(t,r){setTimeout((function(){e(Object(O.b)(t.messageText)),r.setSubmitting(!1),r.resetForm({})}),400)},children:function(e){var r=e.isSubmitting,n=e.errors,o=e.values;return Object(y.jsxs)(f.c,{className:l.a.form,children:[Object(y.jsx)(p.a,{children:Object(y.jsx)(h.a,{span:8,children:Object(y.jsxs)(w,{className:l.a.formItem,children:[Object(y.jsx)(f.b,{name:"messageText",validate:Object(d.b)(30),children:function(e){var t=e.field;return Object(y.jsx)(j.a,Object(a.a)(Object(a.a)({showCount:!0},t),{},{placeholder:"message body",autoFocus:!0}))}}),Object(y.jsx)(f.a,{name:"messageText",component:function(){return Object(y.jsx)("div",{className:R.a.fieldError,children:n.messageText})}})]})})}),Object(y.jsx)(m.a,{className:l.a.SendButton,type:"primary",htmlType:"submit",disabled:r||"close"===t||!o.messageText,children:"add"})]})}})})),S=r(77),N=r(439),T=r.n(N),P=o.a.memo((function(e){var t=e.message;return Object(y.jsxs)("div",{className:T.a.user,children:[Object(y.jsxs)("div",{className:T.a.userInfo,children:[Object(y.jsx)("div",{children:Object(y.jsx)("img",{src:t.photo||S.a,alt:"uerPhoto"})}),Object(y.jsxs)("div",{className:T.a.nameAndMess,children:[Object(y.jsx)("div",{"data-test":"userNameTest",className:T.a.userName,children:t.userName}),Object(y.jsxs)("div",{className:T.a.message,children:[Object(y.jsx)("div",{children:"message:"}),Object(y.jsx)("span",{children:t.message})]})]})]}),Object(y.jsx)("div",{className:T.a.bottomLine})]})})),B=function(e,t){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var E="styles_scrollable-div__prSCv";!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!==typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".styles_scrollable-div__prSCv {\r\n  max-height: inherit;\r\n  height: inherit;\r\n  overflow-y: auto;\r\n}\r\n");var M=function(e){function t(t){var r=e.call(this,t)||this;return r.bottomRef=Object(n.createRef)(),r.wrapperRef=Object(n.createRef)(),r.handleScroll=r.handleScroll.bind(r),r}return function(e,t){function r(){this.constructor=e}B(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.getSnapshotBeforeUpdate=function(){if(this.wrapperRef.current&&this.bottomRef.current){var e=this.props.viewableDetectionEpsilon;return t.isViewable(this.wrapperRef.current,this.bottomRef.current,e)}return!1},t.prototype.componentDidUpdate=function(e,t,r){var n=this.props,o=n.forceScroll;(0,n.changeDetectionFilter)(e,this.props)&&(o||r)&&this.bottomRef.current&&this.wrapperRef.current&&this.scrollParentToChild(this.wrapperRef.current,this.bottomRef.current)},t.prototype.componentDidMount=function(){this.bottomRef.current&&this.wrapperRef.current&&this.scrollParentToChild(this.wrapperRef.current,this.bottomRef.current)},t.prototype.scrollParentToChild=function(e,r){var n=this.props.viewableDetectionEpsilon;if(!t.isViewable(e,r,n)){var o=e.getBoundingClientRect(),s=r.getBoundingClientRect().top+e.scrollTop-o.top,c=this.props,a=c.animateScroll,i=c.onScrollComplete;a&&(a(e,s),i())}},t.isViewable=function(e,t,r){r=r||0;var n=e.getBoundingClientRect(),o=t.getBoundingClientRect(),s=o.top>=n.top,c=n.top+e.clientHeight-o.top;return s&&c+r>=0},t.prototype.handleScroll=function(){var e=this.props,r=e.viewableDetectionEpsilon,n=e.onScroll;n&&this.bottomRef.current&&this.wrapperRef.current&&n(t.isViewable(this.wrapperRef.current,this.bottomRef.current,r))},t.prototype.scrollToBottom=function(){this.bottomRef.current&&this.wrapperRef.current&&this.scrollParentToChild(this.wrapperRef.current,this.bottomRef.current)},t.prototype.render=function(){var e=this.props,t=e.children,r=e.className,o=E+(r?" "+r:"");return Object(n.createElement)("div",{className:o,ref:this.wrapperRef,onScroll:this.handleScroll},t,Object(n.createElement)("div",{ref:this.bottomRef}))},t.defaultProps={forceScroll:!1,animateScroll:function(e,t){e.scrollBy?e.scrollBy({top:t}):e.scrollTop=t},onScrollComplete:function(){},changeDetectionFilter:function(){return!0},viewableDetectionEpsilon:2,onScroll:function(){}},t}(n.Component),D=r(39),I=r(27),F=o.a.memo((function(){return Object(g.c)(D.d)?Object(y.jsxs)("div",{className:c.a.chatPage,children:[Object(y.jsx)(A,{}),Object(y.jsx)(C,{})]}):Object(y.jsx)(I.a,{to:{pathname:"/login"}})})),A=o.a.memo((function(){var e=Object(g.b)(),t=Object(g.c)(v);Object(n.useEffect)((function(){return e(Object(O.c)()),function(){e(Object(O.d)())}}),[e]);var r=t.map((function(e){return Object(y.jsx)(P,{message:e},e.id)}));return Object(y.jsx)("div",{className:c.a.chat,children:Object(y.jsx)(M,{children:r})})}));t.default=F}}]);
//# sourceMappingURL=3.7a9eebee.chunk.js.map